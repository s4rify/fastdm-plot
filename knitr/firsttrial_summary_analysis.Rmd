---
title: "Analysis Summary"
output: html_document
---

```{r setup, include=FALSE, fig.width=6, fig.height=4, dpi=100,warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Raw data
```{r DATA, include=TRUE, echo=FALSE, cache = TRUE}
#library(psych)
filepath = "/home/sarah/rprojects/vars/"
load(paste(filepath, "DATA", sep="/"))
str(DATA)
```

## Check for distribution of reaction times

```{r qqplot, include=TRUE, echo=FALSE,cache=TRUE}
library(car)
#qqnorm(DATA$reactionTime_PT)
qqp(DATA$reactionTime_PT, "norm")
```

## Normalization fo further processing 

```{r qqplotnorm, include=TRUE, echo=TRUE,cache=TRUE}
normalized_RTPT <- log(DATA$reactionTime_PT)
qqp(normalized_RTPT, "norm")
```


## Linear mixed model for reaction time to primary task 
```{r priming model, include=TRUE, echo=FALSE,cache=TRUE, size='small'}
load(paste(filepath, "primingmodel", sep="/"))
summary(priming_model)

```

## Linear mixed model for reaction time to second task
```{r priming model ST, include=TRUE, echo=FALSE,cache=TRUE, size='small'}
load(paste(filepath, "primingmodelST", sep="/"))
summary(priming_model_ST)

```

## Simple linear model on normalized data as a comparison
```{r simple lm, include=TRUE, echo=FALSE,cache=TRUE, size='small'}
load(paste(filepath, "simplelm", sep="/"))
summary(simple_lm_model)

```


## Anova results with linear mixed model for RT PT
```{r priming model anova, include=TRUE, echo=FALSE,cache=TRUE}
load(paste(filepath, "results", sep="/"))
results$anova
```

## ANOVA simple linear model
```{r anova simple lm, include=TRUE, echo=FALSE,cache=TRUE}
results$anova_simple_lm_model
```

## Test results Wilcoxon with linear mixed model for RT PT
```{r priming model wilcoxon, include=TRUE, echo=FALSE,cache=TRUE}
results$wilcoxon
```

## Test results Kurskal Wallis for linear mixed model RT PT
```{r priming model kurskal, include=TRUE, echo=FALSE,cache=TRUE}
results$kurskal_wallis
```


## Model Diagnostics
```{r priming model resids, include=TRUE, echo=FALSE,cache=TRUE}
hist(resid(priming_model), n= 60, main="Residuals of linear mixed model of reaction times to PT")
```    

```{r priming model resids ST, include=TRUE, echo=FALSE,cache=TRUE}
hist(resid(priming_model_ST), n= 60, main="Residuals of linear mixed model of reaction times to ST")
```   

```{r simple lm resids, include=TRUE, echo=FALSE,cache=TRUE}
hist(resid(simple_lm_model), n= 60, main="Residuals of simple linear model to normalized RT PT")
```   

## Plots
```{r lsmeans summary, include=TRUE, echo=FALSE,cache=TRUE}
results$lsmeanssummary
``` 

```{r lsmeans plot, include=TRUE, echo=FALSE,cache=TRUE}
results$lsmeanplot
``` 

```{r dynamite plot, include=TRUE, echo=FALSE,cache=TRUE}
library(sciplot)
load(paste(filepath, "fading_factor", sep="/"))
bp <-with(data=DATA, bargraph.CI(x.factor=DATA$subject, group=fading_factor, response=normalized_RTPT,
                                                              lc=FALSE, xlab="Subjects",
                                                              legend=TRUE, x.leg=3.3, cex.leg=1.3, cex.names=1.5, cex.lab = 1.5,
                                                              ci.fun=function(x) {c(mean(x) - 1.96*se(x), mean(x) + 1.96*se(x))}))
save(bp, file = paste(filepath, "dynamiteplot", sep="/"))
```


